# This is a LIAM2 simulation file. In this first example, we will see how to
# define an extremely simple simulation, how to run it and explore the results.

# Please note that any line starting with a # sign is a comment and is ignored.

# First, we define all our entities, their fields and functions (processes).
# In this case, we define only one 'person' entity, but LIAM2 can work with any
# kind of entity and any number of them.


entities:
  individus:
    fields:
      # All entities have two implicit integer fields: period and id.
      # You do not need to define them.
      - age: int
      - sexe: int

    macros:
      ISMALE: sexe == 0
      ISFEMALE: sexe == 1

    processes:
      - deces:
        - dead: if(
            ISMALE,
            logit_regr(0.0, align='parameters/population/hyp_mortaliteH.csv'),
            logit_regr(0.0, align='parameters/population/hyp_mortaliteF.csv')
            )

        - migration:
            # note : There is only net immigration in the Insee prevision
            - select_men: logit_regr(
                0.0,
                filter= ISMALE,
                align = 'parameters/population/hyp_soldemigH_custom.csv'
                )
            - select_women: logit_regr(
                0.0,
                filter= ISFEMALE,
                align = 'parameters/population/hyp_soldemigF_custom.csv'
                )
            - select: select_men or select_women
            - new('individus',
                filter = select,
                age = age,
                age_en_mois = age_en_mois,
                partner = UNSET,
                civilstate = SINGLE,
                workstate = workstate,
                sexe = sexe,
                productivite = productivite,
                salaire_imposable = salaire_imposable,
                rsti = 0,
                choi = 0,
                migrant = True,
                quimen = 0,
                quifoy = 0,
                dur_in_couple = 0
                )
                #Â select = 2
                # naiss = naiss




simulation:
  # the functions listed in this section are only executed *once* in
  # start_period - 1 (that is 2015 in this case), instead of once per period.
  init:
    - individus: []

  processes:
    - individus: [ageing, deces]

  output:
    file: simul.h5

  assertions: raise       # raise (default), warn, skip
  skip_shows: False
  logging:                # optional
    timings: True       # optional
    level: functions    # optional

  random_seed: 12345       # optional

  start_period: 2010  #01
  # first simulated period is start_period + 1  TODO: a bit ugly !

  periods: 7
